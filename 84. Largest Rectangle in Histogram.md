# 84. Largest Rectangle in Histogram

链接：https://leetcode-cn.com/problems/largest-rectangle-in-histogram/

## map 解法

1. 拿到所有高度的下标
2. 按照高度去遍历下标，向左向右取到最大范围并计算面积

```go
func largestRectangleArea(heights []int) int {
    largest := 0

    heightIndices := map[int][]int{}
    for i, h := range heights {
        if h != 0 {
            heightIndices[h] = append(heightIndices[h], i)
        }
    }

    for h, indices := range heightIndices {
        for len(indices) != 0 {
            offset := indices[0]
            for ; offset>=0 && heights[offset]>=h; offset-- {}
            offset++
            uplimit := indices[0]
            for ; uplimit<len(heights) && heights[uplimit]>=h; uplimit++ {}

            largest = max(largest, h*(uplimit-offset))

            // reduce scannings of same height
            count := 1
            for ; count<len(indices) && indices[count]<uplimit; count++ {}
            indices = indices[count:]
        }
    }

    return largest
}

func max(a, b int) int {
    if a > b { return a }
    return b
}
```

## 解法效果

![84. largest-rectangle-in-histogram](./img/84. largest-rectangle-in-histogram.png)

## 测试用例

```txt
[2]
[5,2]
[2,4]
[2,1,5,6,2,3]
[2,1,5,6,2,3,2,3]
[2,1,5,6,2,3,0,2,1,5,6,2,3]
[2,1,5,6,2,3,1,2,1,5,6,2,3]
```

